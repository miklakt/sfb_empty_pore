\documentclass[10pt, a4paper]{article}
\usepackage{geometry}
\geometry{
    a4paper,
    left= 15mm,
    right = 15mm,
    top=20mm,
    bottom = 25mm,
    }
\usepackage{caption}
\captionsetup[figure]{
    font=small, 
    labelfont=bf
    }

\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage[
    backend=biber,
    natbib=true,
    style=numeric,
    sorting=none
    ]{biblatex}
\usepackage{xcolor}
\usepackage{mathtools}
\usepackage{bm}
\usepackage{multicol}
\usepackage{ltablex}
\usepackage{wrapfig}
\usepackage{float}
\usepackage[utf8]{inputenc}

\usepackage{titlesec}
\titleformat{\section}{\normalfont\fontsize{12pt}{12pt}\selectfont\bfseries}{\thesection}{0.5em}{}
\titlespacing*{\section}{0pt}{0ex}{0.0ex}

\newcommand\todo[1]{\textcolor{red}{#1}}
\newcommand\scalemath[2]{\scalebox{#1}{\mbox{\ensuremath{\displaystyle #2}}}}
\newcommand{\sign}{\text{sign}}

\addbibresource{biblio.bib}
\title{Physical principles of the colloid selective permeation through polymer-filled mesopores.\\
        SUPPLEMENTARY INFORMATION}

\author{Mikhail Y. Laktionov$^1$, Leonid I.Klushin$^{1,2}$, Ralf P.Richter$^3$, France A.M. Leermakers$^4$, Oleg V.Borisov$^1$\\
$^{1}$CNRS, Universit\'e de Pau et des Pays de l'Adour UMR 5254,\\
Institut des Sciences Analytiques et de Physico-Chimie\\
pour l'Environnement et les Mat\'eriaux, Pau, France \\
$^{2}$Institute of Macromolecular Compounds \\
of the Russian Academy of Sciences, \\
199004 St.Petersburg, Russia,\\
$^{3}$University of Leeds, School of Biomedical Sciences, \\
Faculty of Biological Sciences, 
School of Physics and Astronomy, \\
Faculty of Engineering and Physical Sciences,\\  
Astbury Centre for Structural Molecular Biology,\\ 
and Bragg Center for Materials Research,\\ 
Leeds, LS2 9JT, United Kingdom\\
$^{4}$ University of Wageningen, the Netherlands}

\begin{document}
\maketitle

\pagebreak
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{figure*}[htp!]
    \centering
    \includegraphics[scale = 1.0]{fig/pore_cartoon_SI.png}
    \caption{
        Schematic illustration of diffusive transport of nanocolloids through a polymer brush-filled pore.
        \\
        The brush is formed by linear polymer chains (red strands) with a degree of polymerization $N$, which are uniformly grafted with a grafting density $\sigma$ to the inner surface of a cylindrical pore in an impermeable membrane.
        The pore radius is $r_\text{pore}$, and the thickness of the membrane is $L$.
        The polymer chains are flexible, with statistical segment length $a$, and each segment has a volume $\sim a^3$.
        \\
        The presence of polymer chains impedes colloid transport by decreasing the local diffusion coefficient.
        The diffusion coefficient of the particles in the bulk is $D_0$ and depends on the particle size $d$.
        To calculate the insertion free energy of the polymer brush, the solvent and particle are coarse-grained into regular elements (lower inset) having finite volume and contact area.
        The short-range interactions are modeled as contacts between the coarse-grained elements.
        \\
        The energies of 
        \textbf{p}olymer brush–\textbf{c}olloid particle (PC), 
        \textbf{p}olymer brush–\textbf{s}olvent (PS),  
        and \textbf{c}olloid particle–\textbf{s}olvent (CS) contacts are defined by the Flory interaction parameter $\chi$ (upper inset).
        \\
        The pore is permselective to larger particles; larger magenta-colored particles are drawn only on the left side of the membrane to symbolize this effect.
    }
        \label{fig:colloid_transport_SI}
\end{figure*}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Brief Summary of the Computational Routines}
\begin{multicols}{2}

The primary focus of this paper is to calculate the resistance $R$ to the diffusion of nanocolloid particles through a cylindrical polymer brush-filled mesopore in a membrane (see Figure~\ref{fig:colloid_transport_SI}).
The resistance of the pore connects concentration difference to the flux through the pore $J = \Delta c / R$ similar to the Ohm's law, where concentration are defined in the bulk solution on each side of the membrane.

This resistance can be extracted from the stationary solution of the Smoluchowski equation, where $\partial c/\partial t = 0$ eq.~\ref{eq:Smoluchowski} with appropriate boundary conditions.
The components of the Smoluchowski equation are the local diffusion coefficient $D$ and the insertion free energy $\Delta F$, which plays the role of a potential field.

The local diffusion coefficient depends on the polymer volume fraction $\phi$ and the particle size.
The polymer brush forms a polymer solution with a concentration-dependent correlation length $\xi$.
Particles with a size $d > \xi$ experience additional friction as they are trapped by the network of the polymer mesh.
As a result, their diffusion is slowed down compared to that in the pure solvent ($D/D_0 < 1$).
These effects have been studied, and several models have been proposed~\cite{Kohli2012,Cai2011,Holyst2009,Phillies1988}.

In this paper, we adopt the model proposed in~\cite{Cai2011}, which introduces a hopping mechanism for the diffusion of large, non-sticky nanoparticles subjected to topological constraints.
However, since the model assumes non-sticky particles, it might overestimate the diffusion coefficient for particles with high affinity to the polymer.
An adsorbing particle would find itself in more crowded surroundings, thus experiencing a lower diffusion coefficient.
Conversely, the opposite effect is observed for repelling particles, which experience lower resistance to diffusion due to the formation of a depletion region~\cite{Holyst2011}.
This does not invalidate the results presented, as the total resistance is mostly determined by the insertion free energy landscape.
Although the absolute values may be shifted, the trends in the dependencies of the pore resistance on particle parameters would remain the same.

When a nanocolloid particle is inserted into a brush, the free energy of the system changes compared to that of the particle in the bulk solution.
There is an energy penalty as the polymer chains may have less conformational freedom due to the inserted particle; short-range interactions between the colloid and the polymer may be thermodynamically favorable or unfavorable, thus having a positive or negative effect on the insertion free energy penalty $\Delta F$.

In the analytical approach, the insertion free energy penalty $\Delta F$ can be split into two terms: osmotic ($F_{\textrm{osm}}$) and surface ($F_{\textrm{sur}}$), which scale with the particle's volume and surface area, respectively.

To calculate the osmotic term, the Flory osmotic pressure $\Pi$, which depends on the local polymer volume fraction $\phi$ and the polymer-solvent interaction parameter $\chi_{\textrm{PS}}$, is integrated over the particle volume.
The surface contribution is proportional to the particle's surface area, with a surface tension coefficient $\gamma$, and is found by integrating over the particle surface.

The surface tension coefficient $\gamma(\phi, \chi_{\textrm{PS}}, \chi_{\textrm{PC}})$ has a non-trivial dependence on the local polymer volume fraction, the polymer-solvent interaction parameter $\chi_{\textrm{PS}}$, and the polymer-colloid interaction parameter $\chi_{\textrm{PC}}$.
The problem becomes even more complex as the polymer volume fraction $\phi^{\textrm{ins}}$ in the vicinity of the inserted particle becomes distorted compared to that in the undisturbed brush $\phi$, forming a depletion region ($\Delta \phi < 0$) for repulsive and inert and particles, and a region enriched with polymer ($\Delta \phi > 0$) for attractive particles, where $\Delta \phi = \phi^{\textrm{ins}} - \phi$.


To the best of our knowledge, there is no general exact analytical solution to calculate the surface tension coefficient $\gamma$ for a given particle size and local polymer concentration $\phi$.
To account for the local distortion of the polymer volume fraction $\phi$, in eq.~\ref{eq:phi_correction} we introduce a correction to the polymer volume fraction of the empty brush $\phi$, with coefficients $b_0$ and $b_1$, making the apparent volume fraction $\phi^{\ast}$ dependent on the polymer-colloid interaction parameter $\chi_{\textrm{PC}}$ to compute the corrected surface tension coefficient $\gamma(\phi^{\ast}, \chi_{\textrm{PS}}, \chi_{\textrm{PC}})$.

The correction coefficients $b_0$ and $b_1$ can be found by fitting, given that the particle size $d$, polymer concentration profiles $\phi$, interaction parameters $\chi_{\textrm{PS}}$ and $\chi_{\textrm{PC}}$, and the insertion free energy $\Delta F$ are known.

However, within the chosen framework, the insertion free energy $\Delta F$ for a spherical particle with arbitrary diameter $d$ and coordinates of its center, $z_c$ and $r_c$, cannot be calculated directly.
Furthermore, we still lack the local polymer concentration of the undisturbed polymer brush $\phi$ needed to calculate the osmotic pressure $\Pi$ and the surface tension coefficient $\gamma$.


This motivates us to employ an alternative approach to calculate these missing features.
Therefore, we use the Scheutjens-Fleer Self-Consistent Field (SF-SCF) method in this paper.

The SF-SCF numerical method can be used to find the equilibrium distribution of chain molecules.
In this method, space is discretized into a regular lattice, and the average volume fraction of the molecules is calculated at each lattice site, such that the overall system free energy is minimized.

At the core of the method is an iterative search for the segment potential $u$ and the corresponding polymer volume fraction $\phi$, such that the Helmholtz energy of the system is minimized.

The roadmap in Figure~\ref{fig:paper_roadmap} starts with control parameters that define the geometrical features of the pore, polymer brush morphology, particle size, and interaction parameters.
Some of these control parameters and their meanings are shown in Figure~\ref{fig:colloid_transport_SI}.

\begin{figure}[H]
    \centering
    \includegraphics[width = 0.85\linewidth]{fig/roadmap.png}
    \caption{Roadmap of the paper and calculation routines}
    \label{fig:paper_roadmap}
\end{figure}

\end{multicols}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{The SF-SCF Numerical Method}
\begin{multicols}{2}

The method is based on the minimization of the excess Helmholtz energy with the constraint that all volume concentrations sum up to unity (incompressibility condition).
The method uses discrete spatial coordinates; as the system exhibits axial symmetry, the space is discretized into homogeneously curved two-gradient lattices, \emph{i.e.}, a cylindrical lattice with a degenerate angular direction.
The result is a discrete density profile that corresponds to a minimum excess Helmholtz energy.

There are two coordinate axes: longitudinal $z$ and radial $r$ (Figure \ref{fig:sf-scf_scheme}).
While the $rz$ coordinate system looks identical to the two-dimensional Cartesian coordinates (Figure \ref{fig:sf-scf_scheme}, lower frame), each element of the lattice is a square toroid.
The mean-field approximation is applied in the angular direction, meaning properties in the angular direction are uniform.
(For the two-dimensional Cartesian coordinates, each element is a square box with infinite height.)

In the discrete space, the membrane and an inserted colloid particle are coarse-grained and defined as lattice elements impermeable to the solvent and polymer.
The impermeable lattice elements are illustrated with crossed-out cells filled with green (membrane) and yellow (colloid particle) in the lower frame of Figure \ref{fig:sf-scf_scheme}.
In this discrete coarse-grained approach, the membrane is modeled as a rectangular toroid with an inner radius equal to $r_{\textrm{pore}}$ and an outer radius much greater than the inner radius.
The inserted particle is modeled as a cylinder with height and diameter $d$.

The polymer chain is modeled as a freely jointed chain (FJC) with segment length $a$; every next segment performs a step-weighted random walk on the lattice (red chain in Figure \ref{fig:sf-scf_scheme}).
The weights of each step direction depend on the boundary conditions and the lattice curvature.
For example, steps that end up in impermeable lattice cells have zero weights; in the cylindrical lattice, steps to the cells within the layer with lower curvature (larger radial coordinate) are more preferable.
The resulting local polymer concentration $\phi$ is a weighted sum of all possible paths the chain can take, eq.~\ref{eq:sum_to_phi}.

To minimize the excess Helmholtz energy, we introduce a Lagrangian with multipliers $\alpha(r, z)$:
\begin{equation}
    \label{eq:fe_lagrangian}
    \begin{aligned}
        &F[\mathbf{u}, \boldsymbol{\phi}, \boldsymbol{\alpha}] =\\
        &= F_{ent}[\mathbf{u}] - \sum\limits_{r,z} \sum\limits_X u_X(r, z) \phi_X(r, z) + \\
        &+ F_{int} [\boldsymbol{\phi}] 
        + \sum\limits_{r,z} \alpha(r, z) \left( \sum\limits_X \phi_X(r, z) - 1 \right)
    \end{aligned} 
\end{equation}

where $\phi_X(r, z)$ is the local volume concentration function of segment type $X$ (polymer, colloid, or solvent), $u_X(r, z)$ is the potential field of segment type $X$, the functional $F_{ent}[\mathbf{u}]$ is the mixing entropy term, and the functional $F_{int} [\boldsymbol{\phi}]$ is the interaction part of the free energy.

The condition for the minimum of the functional is a system of three variational equations:
\begin{equation}
    \label{eq:energy_min_system}
    \begin{cases}
        \frac{\partial F}{\partial \boldsymbol{\alpha}} = 0 \\
        \frac{\partial F}{\partial \boldsymbol{\phi}} = 0 \\
        \frac{\partial F}{\partial \mathbf{u}} = 0 \\
    \end{cases}
\end{equation}

The first condition in eq.~\ref{eq:energy_min_system} ensures system incompressibility.

The second condition in eq.~\ref{eq:energy_min_system} results in the segment potential field equation for a regular solution:
\begin{equation}
    \label{eq:u-phi}
    u_A(r, z) =\sum\limits_{B} \chi_{A,B} \left(\phi_B(r,z) - \phi_B^b \right) + \alpha(r, z)
\end{equation}
where $\chi_{A,B}$ is the Flory interaction parameter between segments $A$ and $B$, and $\phi_B^b$ is the volume fraction of $B$ in the bulk (equal to 1 for the solvent and zero otherwise).

Minimization with respect to potentials (the third condition in eq.~\ref{eq:energy_min_system}) links the chain partition function with the local polymer concentration $\phi$ in a diffusion-like equation (eq.~\ref{eq:propagation}).

\begin{figure}[H]
    \centering
    \includegraphics[width = 0.7\linewidth]{fig/sf-scf_scheme.png}
    \caption{
    Schematic layout of the lattice and geometrical features of the cylindrical pore model in the SF-SCF method.
    The modeled objects are in the upper frame, and their representation on a discrete two-gradient lattice is on the lower frame.
    }
\label{fig:sf-scf_scheme}
\end{figure}

Any subchain of the FJC can be considered a Markov process starting at some segment $s_i$ at coordinates $r_i, z_i$ that goes through intermediate steps to segment $s_k$ at coordinates $r_k, z_k$ (red chain in Figure \ref{fig:sf-scf_scheme}).
Such a process has a statistical weight $G(\{r_k, z_k\}, s_k | \{r_i, z_i\}, s_i)$.
All the Markov processes that start with segment $s_i$ and end with segment $s_k$ at fixed coordinates $\{r, z\}$ are found as the sum over all possible starting coordinates:
\begin{equation}
    \label{eq:sum_to_phi}
    G(\{r, z\}, s_k | s_i) = \sum_{r^{\prime}, z^{\prime}} G(\{r, z\}, s_i | \{r^{\prime}, z^{\prime}\}, s_i)
\end{equation}


The statistical weight of all possible processes that start from segment $s_i$ and end with segment $s_k$ is the sum over all possible coordinates:
\begin{equation}
    G(s_k | s_i) = \sum_{r, z} G(\{r, z\}, s_k | s_i)
\end{equation}

When $s_i=1$ and $s_k=N$, the result contains the statistical weight of all possible and allowed conformations of the chain and is the single-chain partition function $G(N|1)$.

Let $G(r, z) = G(\{r, z\}, 1|1)$ be the initial condition of the Markov process, which contains just one segment (starts and ends at segment $1$).
The segment potential $\mathbf{u}$ acts on this segment; thus, Boltzmann statistical weights are applied:
\begin{equation}
    G(r, z) = \exp(-u(r,z))
\end{equation}

The volume density distribution of segment $s_i$ at coordinates $r, z$ is found from the composition law:
\begin{equation}
    \label{eq:propagation}
    \begin{aligned}
        &\phi(\{r, z\}, s_i) = \\
        &\frac{2 \pi r_{\textrm{pore}} \sigma N}{G(N|1)}
        \frac{G(\{r, z\}, s_n | 1) G(\{r, z\}, (N - s_n + 1) | 1)}{G(r, z)}
    \end{aligned}
\end{equation}
where $G(\{r, z\}, s_n | 1)$ and $G(\{r, z\}, (N - s_n + 1) | 1)$ are forward and backward propagators, respectively; $\sigma$ is the grafting density, and $N$ is the chain length.

Finally, the volume concentration at coordinates $r, z$ is found as the sum over all chain segments:
\begin{equation}
    \phi(r, z) = \sum_{i}^{N} \phi(\{r, z\}, s_i)
\end{equation}

The numerical algorithm solves the Scheutjens-Fleer system of nonlinear equations such that the segment potential $\mathbf{u}$ is consistent with the volume concentration $\boldsymbol{\phi}$.
The relationship between the segment potential and the volume concentration is defined in eq.~\ref{eq:u-phi}.

The SF-SCF scheme can be summarized as:
\begin{equation}
    \boldsymbol{u}[\boldsymbol{\phi}] \xleftrightarrow[]{\sum_{X} \phi_X = 1} \boldsymbol{\phi}[\boldsymbol{u}]
\end{equation}

For the calculations, we use the package \emph{SFbox} kindly provided by F.A.M. Leermakers~\todo{[refs]}.
The package contains several Newton/Quasi-Newton optimization routines to perform the minimization of the functional eq.~\ref{eq:fe_lagrangian}.
Each iteration returns a new improved approximation to the segment potential $\mathbf{u}$ and updates the volume concentrations $\mathbf{\phi}$.
The routine loops until the desired accuracy is reached.

\end{multicols}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Extracting Surface and Volume Contributions to Colloid Insertion Free Energy from SF-SCF Data}

\begin{multicols}{2}

The analytical approach to calculate the insertion free energy $\Delta F$ requires integration over the particle.
The general equations are given further, see eqs.~\ref{eq:Delta_F_V},~\ref{eq:Delta_F_S},~\ref{eq:Delta_F}.
Let us start with the continuous form to integrate over the surface and volume of a cylindrical particle coaxial to $z$-axis.
The analytical insertion free energy for a cylindrical particle coaxial with the $z$-axis can be written as follows:

\begin{equation}
    \Delta F_{\textrm{cyl}}^{\textrm{osm}}(z_c) = 2 \pi \int_{z_c - d/2}^{z_c + d/2} \int_{0}^{d/2} \Pi(r, z) \, r \, dr \, dz
\end{equation}

\begin{equation}\label{eq:continuous_surf_int}
    \begin{aligned}
        \Delta F_{\textrm{cyl}}^{\textrm{sur}}(z_c) = 2 \pi d \int_{z_c - d/2}^{z_c + d/2} \gamma(d/2, z) \, dz +\\
        + \pi \int_{0}^{d/2} \left[ \gamma(z_c - d/2, r) + \gamma(z_c + d/2, r) \right] dr
    \end{aligned}
\end{equation}

In eq.~\ref{eq:continuous_surf_int}, the first term integrates the surface tension coefficient over the lateral surface of the cylindrical particle, and the second term integrates over the top and bottom bases of the cylinder.

We remind that the SF-SCF method utilizes space discretization; inherently, the polymer brush concentration and all derived properties are defined on a discrete two-dimensional grid and can be represented as matrices, for example, $\phi(r, z)$ and $\boldsymbol{\phi}$ indexed with $i$ and $k$.

We follow the following convention for indices: $i$ iterates in the direction of the $r$-axis, with larger values corresponding to lattice elements farther from the $z$-axis; the indices start from $i=0$.

Let us switch to integration on the discrete cylindrical lattice.
Consider a particle centered at $r_c = 0$, $z = z_c$.
The particle occupies $d$ lattice elements along the $z$-axis (from $z_c - d/2$ to $z_c + d/2$) and $d/2$ elements along the $r$-axis (from $r = 0$ to $r = d/2$), as shown by the yellow rectangle in the lower frame of Figure~\ref{fig:sf-scf_scheme}.

We define the particle volume projection matrix $\mathbf{V}_{\textrm{cyl}}[d/2 \times d]$ for a cylindrical particle of size $d$, such that each element of the matrix equals the volume of the particle contained within the corresponding lattice element
Obviously, the sum of all matrix elements equals the volume of the cylindrical particle.

\begin{eqnarray}
    V_{\textrm{cyl}}[i, k] = \pi(2i + 1) \\
    \sum_{i=0}^{d/2 - 1} \sum_{k=0}^{d - 1} V_{\textrm{cyl}}[i, k] = \frac{\pi d^3}{4}
\end{eqnarray}

We define the particle surface projection matrix $\mathbf{S}_{\textrm{cyl}}[d/2 \times d]$, such that each element of the matrix equals the surface area of the particle contained within the corresponding lattice element.


\begin{align}
    \begin{split}
        S_{\textrm{cyl}}[i, k] = 
        &\begin{cases}
            2 \pi i,   & \text{if } i = d/2 - 1 \\
            0,         & \text{otherwise}
        \end{cases}
        \\
        &+
        \begin{cases}
            2 \pi (i + 1), & \text{if } k = 0 \text{ or } k = d - 1 \\
            0,             & \text{otherwise}
        \end{cases}
    \end{split}
\end{align}

Here, the first term accounts for the top and bottom bases of the cylindrical particle, and the second term accounts for the lateral surface elements of the cylinder.

Again, the sum of all matrix elements equals the surface area of the cylindrical particle:

\begin{equation}
    \sum_{i=0}^{d/2 - 1} \sum_{k=0}^{d - 1} S_{\textrm{cyl}}[i, k] = \frac{3 \pi d^2}{2}
\end{equation}

In Figure~\ref{fig:cylindrical_kernel_SI}, we present a color visualization of the volume $\mathbf{V}_{\textrm{cyl}}$ and surface $\mathbf{S}_{\textrm{cyl}}$ projection matrices for a cylindrical particle with diameter and height $d = 8$.
The element values of the matrices are color-coded such that larger values are represented by yellow tiles, and lower ones by dark blue.

\begin{figure}[H]
    \centering
    \includegraphics[width = \linewidth]{fig/cylindrical_kernel_SI.png}
    \caption{Volume and surface projection matrices for a cylindrical particle with diameter and height $d = 8$}
    \label{fig:cylindrical_kernel_SI}
\end{figure}

To calculate the analytical insertion free energy, we integrate the osmotic pressure over the particle volume and the surface tension coefficient over the particle surface.
Integration on a discrete lattice can be defined as a matrix dot product; for example, the osmotic term $\Delta F_{\textrm{cyl}}^{\textrm{osm}}(z_c)$ is calculated as follows:

\begin{equation}\label{eq:cyl_fe_osm}
    \begin{split}
        \Delta F_{\textrm{cyl}}^{\textrm{osm}}(z_c) &= \sum_{i=0}^{d/2 - 1} \sum_{k=0}^{d - 1} V_{\textrm{cyl}}[i, k] \cdot \Pi[i, z_c - d/2 + k] \\
        &= \mathbf{V}_{\textrm{cyl}} \cdot \boldsymbol{\Pi}\{z_c\} \\
        \text{where } \boldsymbol{\Pi}\{z_c\} &= \left( \Pi_{i, k} \right)_{\substack{0 \leq i < d/2 \\ z_c - d/2 \leq k < z_c + d/2}}
    \end{split}
\end{equation}

Similarly, we calculate the surface term:

\begin{equation}\label{eq:cyl_fe_sur}
    \Delta F_{\textrm{cyl}}^{\textrm{sur}}(z_c) = \mathbf{S}_{\textrm{cyl}} \cdot \boldsymbol{\gamma}\{z_c\}
\end{equation}

The discrete insertion free energy profile $\Delta F_{\textrm{cyl}}$ is defined as a series of insertion free energy calculations performed for all possible particle center positions $z_c$.
Such a series of sequential integrations (matrix dot products) is equivalent to the convolution with the particle volume/surface projection matrix acting as a kernel:

\begin{eqnarray}
    \Delta F_{\textrm{cyl}}^{\textrm{osm}} = \boldsymbol{\Pi} \ast \mathbf{V}_{\textrm{cyl}} \\
    \Delta F_{\textrm{cyl}}^{\textrm{sur}} = \boldsymbol{\gamma} \ast \mathbf{S}_{\textrm{cyl}}
\end{eqnarray}

We remind that the cylindrical particle is always coaxial with the $z$-axis; thus, $\Delta F_{\textrm{cyl}}^{\textrm{osm}}$ and $\Delta F_{\textrm{cyl}}^{\textrm{sur}}$ are one-dimensional arrays.It is worth noting that convolution is a computationally efficient operation, often performed via FFT (Fast Fourier Transform), which we also exploited.

\end{multicols}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Mapping between SF-SCF and Analytical Approaches: Correction Coefficients}
\begin{multicols}{2}

In the previous sections, we discussed how the insertion free energy profile for a cylindrical particle coaxial to the $z$-axis ($\Delta F_{\textrm{cyl}}$) can be calculated by discrete integration over the particle volume and surface using only the local polymer concentration of the unperturbed polymer brush, $\phi$.

Naturally, when a particle is inserted into a polymer brush, it perturbs the polymer brush.
The particle expels the polymer brush from the volume it occupies.
Depending on the particle-polymer interactions, a particle can attract or repel the polymer around it, causing local perturbations within a distance of a few Kuhn segments.

The free energy of the system changes compared to that of the particle in the bulk.
The main premise of the analytical approach is the separation of the insertion free energy into two contributions:
\begin{eqnarray}
    \label{eq:Delta_F} \Delta F &=& \Delta F_{\textrm{osm}} + \Delta F_{\textrm{sur}} \\
    \label{eq:Delta_F_V} \Delta F_{\textrm{osm}} &=& \int_{V} \Pi(r, z) \, dV \\
    \label{eq:Delta_F_S} \Delta F_{\textrm{sur}} &=& \oint_{S} \gamma(r, z) \, dS
\end{eqnarray}

The osmotic contribution is found using the Flory mean-field approach, while the surface contribution requires the coefficients $b_0$ and $b_1$ we introduced into the analytical approach:
\begin{eqnarray}
    \gamma &=& \frac{1}{6} (\chi_{\textrm{ads}} - \chi_{\textrm{crit}}) \phi^{\ast} \\
    \chi_{\textrm{ads}} &=& \chi_{PC} - \chi_{PS} (1 - \phi^{\ast}) \\
    \phi^{\ast} &=& (b_0 + b_1 \chi_{PC}) \phi \label{eq:phi_correction}
\end{eqnarray}
Here, $\gamma$ is the free energy change upon replacing a contact of unit surface area between the particle and the pure solvent with a contact between the particle and a polymer solution of concentration $\phi$.
The coefficients $b_0$ and $b_1$ are introduced to capture the local perturbation to the polymer brush concentration profile.

We performed a large number of SF-SCF computations with the particle center position $z_c$ moved along the $z$-axis, varying the particle size $d$ and the interaction parameters $\chi_{\textrm{PS}}$ and $\chi_{\textrm{PC}}$.
From the results of the SF-SCF computations, we constructed a set of insertion free energies $\Delta F_{\textrm{SF-SCF}}$, indexed by a set of control parameters $(z_c, d, \chi_{\textrm{PS}}, \chi_{\textrm{PC}}, \dots)$.

The insertion free energy profiles $\Delta F_{\textrm{SF-SCF}}(z_c)$ are gathered into series with fixed particle size $d$, fixed parameters of the pore ($r_{\textrm{pore}}, s$), and the brush ($N, \sigma$), as well as fixed interaction parameters $\chi$.
For each of these series, we performed a ground state free energy correction, meaning that the total free energy for a particle far away from the pore is subtracted to ensure the reference value $\Delta F_{\text{SF-SCF}}(z_c \to \pm \infty) = 0$.

The particle sizes ranged from small particles with diameter and height $d = 4$ to larger ones with $d = 32$.
The interaction parameters ranged from poor solvents ($\chi_{\textrm{PS}} > 0.5$) to good solvents ($\chi_{\textrm{PS}} < 0.5$), and from repelling colloid particles ($\chi_{\textrm{PC}} > \chi_{\textrm{PC}}^{\textrm{crit}}$) to attractive colloid particles ($\chi_{\textrm{PC}} < \chi_{\textrm{PC}}^{\textrm{crit}}$), where $\chi_{\textrm{PC}}^{\textrm{crit}} = \chi_{\textrm{crit}} + \chi_{\textrm{PS}} (1 - \phi)$.

A set of insertion free energies $\Delta F_{\textrm{cyl}}(b_0, b_1)$ can be computed analytically (as described in the previous section) for the same set of control parameters if the correction coefficients $b_0$ and $b_1$ are known.

We chose to perform the fit using only smaller particles with diameter and height $d = 4$, to exclude large perturbations to the polymer volume concentration $\phi$
The correction coefficients $b_0$ and $b_1$ were found to minimize the difference between $\Delta F_{\textrm{SF-SCF}}$ and $\Delta F_{\textrm{cyl}}(b_0, b_1)$.

To illustrate the effect of the fit, in Figure~\ref{fig:fit_SI} we compare the SF-SCF and analytical results of the insertion free energy penalty $\Delta F_{\textrm{SF}}$ and $\Delta F_{\textrm{cyl}}$ as a function of the particle center position $z_c$ for small cylindrical particles with diameter and height $d = 4$, for different affinities ($\chi_{\textrm{PC}} = 0.00$, $-0.75$, $-1.50$) in a $\theta$-solvent with $\chi_{\textrm{PS}} = 0.5$.
We treat the SF-SCF results as the reference values for our analytical approach (circle markers in Figure~\ref{fig:fit_SI}).

Let us assume that particle insertion causes no perturbation to the polymer brush; then, in eq.~\ref{eq:phi_correction}, $\phi^{\ast} = \phi$, and $b_0 = 1$, $b_1 = 0$ (dashed line in Figure~\ref{fig:fit_SI}).
As expected because of the local perturbation to polymer concentration these results diverge from the SF-SCF predictions for inert particles ($\chi_{\textrm{PC}} = 0$) and strongly adsorbing particles ($\chi_{\textrm{PC}} = -1.5$), as seen from the dashed lines in Figure~\ref{fig:fit_SI}.


Although the fit was performed only for the smaller particles, the insertion free energies calculated by both approaches, $\Delta F_{\textrm{SF-SCF}}$ and $\Delta F_{\textrm{cyl}}$, agree well for particles with diameter and height up to $d = 16$ (see Figure~3 in the main text) across a wide set of control parameters $z_c$, $\chi_{\textrm{PS}}$, and $\chi_{\textrm{PC}}$.
We estimate the correction coefficient to be $b_0=0.7$ and $b_1 = -0.3$ as seen from the solid lines and circle markers in Figure~\ref{fig:fit_SI}.

We remind that the insertion free energy calculated analytically, $\Delta F_{\textrm{cyl}}$, uses the unperturbed polymer concentration profile $\phi$.
When a larger particle (with size comparable to the pore size or to the distance to the grafting surface) is inserted, it causes significant non-local changes in the polymer concentration.
Larger particles cause polymer brush compression, which translates to an additional free energy penalty not accounted for by the analytical approach; this effect is also seen in Figure~\ref{fig:fe_scf_grid}.


An interesting effect can be observed for strongly attractive particles.
The SF-SCF results predict that, to reach the minimum of the insertion free energy $\Delta F_{\textrm{SF}}$, the polymer brush changes conformation to reach the particle at a greater distance $|z_c|$ from the pore.
In Figure~\ref{fig:fit_SI}, this effect is apparent for the $\chi_{\textrm{PC}} = -1.5$ results (blue curves and markers), where the SF-SCF results predict systematically lower insertion free energies than the analytical approach at $|z_c| > 26$.
This effect is mild and only slightly increases the region with negative insertion free energy.
It does not significantly change the total resistance to diffusion transport, because for pores with regions of negative insertion free energy, the total resistance is defined by the resistance of the reservoir, which is explored in further sections.

\begin{figure}[H]
    \centering
    \includegraphics[width = 0.9\linewidth]{fig/fit_SI.png}
    \caption{
    Comparison of fitted (solid lines) and non-fitted (dashed lines) approximate analytical results (eqs.~\ref{eq:cyl_fe_osm} and~\ref{eq:cyl_fe_sur}) for insertion free energy penalty with numerical SF-SCF results (circles) for cylindrical particle with diameter and height $d = 4$.
    The results are presented for a representative pore at $\chi_{\textrm{PS}} = 0.5$ for a set of $\chi_{\textrm{PC}}$ values.
    The $\chi_{\textrm{PC}}$ values are color-coded and marked on the right side of the figure.
    }
    \label{fig:fit_SI}
\end{figure}

\begin{figure}[H]
    \centering
    \includegraphics[width = 0.95\linewidth]{fig/fe_scf_grid2.png}
    \caption{ 
    Comparison of the insertion free energy as a function of particle position $z_c$ calculated using an approximate analytical approach and the SF-SCF method for cylindrical particles with diameter and height $d = [8, 12, 16]$ (color coded).
    The solvent quality is varied near the $\theta$-point with $\chi_{\textrm{PS}} = [0.4, 0.5, 0.6]$, corresponding to columns from left to right, respectively.\\
    The results are presented for two particle affinities to polymer chains: $\chi_{\textrm{PC}} = -0.5$ in the middle row and $\chi_{\textrm{PC}} = -1.0$ in the bottom row, \emph{i.e.}, from less to more attractive particles.\\
    The insertion free energy calculated with the SF-SCF scheme, $\Delta F_{\textrm{SF-SCF}}$, is shown with squares, and the results of the approximate analytical scheme, $\Delta F_{\textrm{cyl}}$, are presented with solid lines.\\
    The light green hatched area marks values of $z$ that correspond to the volume inside the pore $z \in [-26, 26]$.
    \label{fig:fe_scf_grid}
    }
\end{figure}

\end{multicols}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Mapping between SF-SCF and Analytical Approaches: Arbitrarily Placed Homogeneous Spherical Colloid}

\begin{multicols}{2}

In the previous sections, we created a mapping between the analytical approach for calculating insertion free energy and the numerical SF-SCF approach.
The SF-SCF method is limited to cylindrical particles moving along the main axis of the pore.
Here, we generalize the analytical approach to arbitrarily placed homogeneous spherical nanocolloid particles.

We remind that the system features exhibit axial symmetry; hence, the natural choice is the cylindrical coordinate system.
As the polymer brush profiles and pore geometrical features are uniform in the angular direction, we use $rz$ cylindrical coordinates with a degenerate angular axis.
In other words, any property such as polymer concentration can be expressed as a function $f(r, z, \theta) = f(r, z)$.

The transformation from cylindrical coordinates $(r, z, \theta)$ to Cartesian coordinates is:

\begin{equation}
    \bm{T}(r, z, \theta) = 
    \begin{pmatrix}
        x = r \cos \theta\\
        y = r \sin \theta\\
        z = z
    \end{pmatrix}
\end{equation}

Let $\Delta_{\textrm{center}} = \sqrt{r^2 + r_c^2 - 2 r r_c \cos(\theta) + (z - z_c)^2}$ be the distance to the particle center $(r_c, z_c, \theta_c)$ in the cylindrical coordinate system; without loss of generality, we set $\theta_c = 0$.

Note the identities used in the later expressions:

\begin{gather}
    \bm{J} = 
    \begin{pmatrix}
        \cos{\theta} & -r\sin\theta & 0 \\
        \sin{\theta} &  r\cos\theta & 0 \\
        0           & 0            & 1
    \end{pmatrix}\\
    \det(\bm{J}) = r \\
    \left| \hat{n} \cdot \frac{\partial \bm{T}}{\partial \theta} \right| = \frac{-r^2 \sin \theta + r r_c \sin \theta \cos \theta}{\Delta_{\textrm{center}}}\\
    \left| \frac{\partial \bm{T}}{\partial r} \times \frac{\partial \bm{T}}{\partial z} \right| = 1\\
    dA = \frac{\left|\frac{\partial \bm{T}}{\partial r} \times \frac{\partial \bm{T}}{\partial z} \right|}{\left|\hat{n}(r, z, \theta) \cdot \frac{\partial\bm{T}}{\partial \theta}\right|} dr dz
\end{gather}
where $\bm{J}$ is the Jacobian matrix, and $\hat{n}$ is a normal to the surface, $dA$ is differential element of area.

Let us define some volume $V$ with an indicator function:

\begin{eqnarray}
    \bm{1}_V =
    \begin{cases}
        1 & \text{if } (r, z, \theta) \in V\\
        0 & \text{if } (r, z, \theta) \notin V
    \end{cases}
\end{eqnarray}

Let us integrate a function that does not depend on the angular coordinate, $f(r, z, \theta) = f(r, z)$, over some volume defined by the indicator function:

\begin{eqnarray}
    \label{eq:int_indicator_V}
    \begin{split}
        \int\limits_{V} f dV
        =\int\displaylimits_{0}^{+\infty} \int\displaylimits_{-\infty}^{+\infty} \int\displaylimits_{0}^{2\pi} f(r, z) \bm{1}_V  dr dz d\theta =\\
        =\int\displaylimits_{0}^{+\infty} \int\displaylimits_{-\infty}^{+\infty} f(r, z) \int\displaylimits_{0}^{2\pi}  \bm{1}_V dr dz d\theta =\\
        =\int\displaylimits_{0}^{+\infty} \int\displaylimits_{-\infty}^{+\infty} f(r, z)  V_{\theta \downarrow} dr dz
    \end{split}
\end{eqnarray}

Similarly, when a surface is defined via an indicator function $\bm{1}_S$, we can integrate a function that does not depend on the angular coordinate, $f(r, z, \theta) = f(r, z)$, over the surface $S$:

\begin{eqnarray}
    \label{eq:int_indicator_S}
    \begin{split}
        \int\limits_{S} f dS = \int\displaylimits_{0}^{+\infty} \int\displaylimits_{-\infty}^{+\infty} \int\displaylimits_{0}^{2\pi} f(r, z) \bm{1}_S  dA =\\
        =\int\displaylimits_{0}^{+\infty} \int\displaylimits_{-\infty}^{+\infty} f(r, z)  S_{\theta \downarrow} dr dz
    \end{split}
\end{eqnarray}

We dropped the angular dimension by projecting the integration volume $V_{\theta \downarrow}$ and surface $S_{\theta \downarrow}$ onto the $rz$-plane, exploiting the fact that the integrand function does not depend on the angular coordinate.
This reduction effectively simplifies the integration, allowing to perform it in two dimensions rather than three, as the angular dependence can be factored out.

According to eq.~\ref{eq:Delta_F_V}, to find the osmotic term in the insertion free energy $\Delta F_{\textrm{osm}}$, we integrate the Flory osmotic pressure $\Pi(r, z)$ over the particle volume.
As in eq.~\ref{eq:Delta_F_S} To find the surface term $\Delta F_{\textrm{sur}}$, we integrate the surface tension coefficient $\gamma(r, z)$ over the particle surface.

We follow the integration using the indicator function described in eqs.~\ref{eq:int_indicator_V},~\ref{eq:int_indicator_S} to integrate the osmotic pressure over the particle volume and the surface tension coefficient over the particle surface.
The particle volume $V_{\theta \downarrow}$ and surface projection $S_{\theta \downarrow}$ onto the $rz$-plane in cylindrical coordinates are:

\begin{gather}
    V_{\theta \downarrow}(r, z, r_c, z_c) = 2\int_{0}^{\pi} H\left( \Delta_{\textrm{center}} - \frac{d}{2} \right) r \, d\theta
    \\
    S_{\theta \downarrow}(r, z, r_c, z_c) = 2\int_{0}^{\pi} \frac{\delta \left( \Delta_{\textrm{center}} - \frac{d}{2} \right) \Delta_{\textrm{center}}}{-r \sin \theta + r_c \sin \theta \cos \theta} \, d\theta
\end{gather}
where $H$ is the Heaviside function and $\delta$ is the Dirac delta function.
The function domain, values and discretization for $V_{\theta \downarrow}$ and $S_{\theta \downarrow}$ are exemplified in Figure~\ref{fig:sphere_volume_and_surface_projection} for a set of particle center offset $r_c$.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.9\linewidth]{fig/spherical_kernel.png}
    \caption{
        Spherical particle volume and surface projection matrices in a cylindrical lattice.
        In the figure, we exemplify the volume projection matrix $\bm{V}\{r_c\}$ for a spherical particle with diameter $d = 12$ and an offset to $z$-axis $r_c= 8$.
        The colored tiles encode the matrix elements' values, where yellow means larger values and dark blue means lower values.
        The geometrical meaning of the matrix element is the particle volume (red body) or surface (green small patch) found in the domain $r,z \in [i, i + \delta r] \times [k, k + \delta z]$ (opaque blue toroid).
        The smaller drawing on the right side complements the main drawing with a $z$-view for clarity.
    }
    \label{fig:spherical_kernel}
\end{figure}

To find the elements of the projection matrices, we discretize the projections by integrating over a set of domains $r, z \in [i, i + \delta r] \times [k, k + \delta z]$ for possible indices $i, k$:

\begin{eqnarray}
    V(r_c)_{[i, k]} = \iint \limits_{i, k}^{\substack{i+\delta r\\ k+\delta z}} V_{\theta \downarrow} (r, z, r_c, z_c) dr dz
    \\
    S(r_c)_{[i, k]} = \iint \limits_{i, k}^{\substack{i+\delta r\\ k+\delta z}} V_{\theta \downarrow} (r, z, r_c, z_c) dr dz
\end{eqnarray}
where $z_c$ has an arbitrary value.
The size of the projection matrices is $\min(d, r_c + d/2) \times d$.
Compared to Cartesian projections, cylindrical projections depend on the radial coordinate of the center $r_c$.

The discrete form of eq.~\ref{eq:Delta_F_V} to calculate the osmotic term in the insertion free energy for a spherical particle is:

\begin{eqnarray}
    \begin{split}
        \Delta F_{\textrm{osm}}(r_c, z_c) =\\
        = \mathop{\sum\sum}_{\mathclap{\substack{i \in [0, \min(r_c+d/2,d)-1] \\ k \in [0, d-1]}}} V{r_c}_{[i, k]} \cdot \Pi_{[\max(r_c-d/2,0)+i, z_c-d/2+k]} =\\[-15pt]
        = \bm{V}\{r_c\} \cdot \bm{\Pi}\{r_c, z_c\} \\[5pt]
        \text{where } \bm{\Pi}\{r_c,z_c\} =\left(\bm{\Pi}_{i,k}\right) {\substack{\max(r_c-d/2,0) \le i < r_c+d/2 \\ z_c-d/2 \le k < z_c+d/2}}
    \end{split}
\end{eqnarray}

Similarly, the surface term in the insertion free energy is the following matrix multiplication:

\begin{eqnarray}
    \begin{split}
        \Delta F_{\textrm{sur}}(r_c, z_c) = \bm{S}\{r_c\} \cdot \bm{\gamma}\{r_c, z_c\} \\[5pt]
        \text{where } \bm{\gamma}\{r_c,z_c\} =\left(\bm{\gamma}_{i,k}\right) {\substack{\max(r_c-d/2,0) \le i < r_c+d/2 \\ z_c-d/2 \le k < z_c+d/2}}
    \end{split}
\end{eqnarray}

The discrete volume and surface projections have a geometrical meaning.
We illustrate this in Figure~\ref{fig:spherical_kernel}, where the volume and surface projections are explained geometrically.
The particle center has an offset $r_c$ from the cylindrical lattice's $z$-axis.
To construct the particle volume projection elements $V(r_c)[i, k]$, for each lattice element (blue opaque square toroid), we determine the volume of the lattice element occupied by the particle (red body, marked with the word 'volume')
The particle surface projection element $S(r_c)[i, k]$ is the piece of the particle surface (green patch, marked with the word 'surface') encompassed within a lattice element.
As an example, a $16 \times 16$ volume projection matrix $V(r_c = 8)[i, k]$ for a spherical particle with diameter $d = 16$ is shown as a blue-green-yellow colormap, where blue color indicates that the lattice element is not occupied by the particle.


\end{multicols}

%\pagebreak
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Effects of Volume Exclusion Due to Pore Walls}

\begin{multicols}{2}

\begin{figure}[H]
    \centering
    \includegraphics[width=0.9\linewidth]{fig/excluded_volume_SI.png}
    \caption{
        In the left frame, the effective pore shape is traced with a dashed red line
        The excluded volume is created by a spherical particle with diameter $d$ and is shown with a red shade.
        In the right frame, the excluded volume is shown on the regular lattice on the $rz$-plane.
        The excluded volume on the regular lattice is a result of a morphological binary dilation $\bm{W}^{\ast} = \bm{W} \bigoplus \bm{V}$.
        }
    \label{fig:excluded_volume}
\end{figure}

Naturally, a colloid particle cannot occupy the space near the membrane walls.
In general, for a particle of arbitrary shape, there are translational and orientational constraints; a region close to the walls does not allow for certain orientations of the particle or positions of its center.

Spherical particles have only translational non-interference constraints; the excluded volume can be seen as a morphological dilation of the membrane body.
The morphological dilation in this case is the locus of points covered by a sphere when the center of the sphere moves inside the membrane body.

The space impermeable to a spherical particle is an effective pore with a radius smaller than the actual pore radius, $r_{\textrm{pore,eff}} = r_{\textrm{pore}} - \frac{d}{2}$, and thicker walls, $L_{\textrm{eff}} = L + d$, with rounded corners, as shown in the upper frame of Figure~\ref{fig:excluded_volume}.

Since the space is discretized into a regular grid, the membrane impermeable to the brush is defined as a two-dimensional Boolean array $\bm{W}$, where $W[i, k] = \textrm{True}$ indicates the wall.

Let us introduce another coarse-grained representation for a particle:
\begin{equation}
    V[i, k] = 
    \begin{cases}
            1, & \text{if } \left( \dfrac{d}{2} - i - \dfrac{1}{2} \right)^2 + \left( \dfrac{d}{2} - k - \dfrac{1}{2} \right)^2 \le \dfrac{d^2}{4} \\
            0, & \text{otherwise}
        \end{cases}
\end{equation}
The two-dimensional Boolean array $\bm{V}$ is shown in the right frame of Figure~\ref{fig:excluded_volume} as lattice elements filled with orange color; the spherical particle is shown in the left frame.

The array $\bm{V}$ indicates whether any piece of the particle present in a domain $r,z \in [i, i + \delta r] \times [k, k + \delta z]$ for a given indices $i,k$.

The space impermeable to a spherical particle includes the membrane and the excluded volume, and is defined as a two-dimensional Boolean array $\bm{W}^{\ast} = \bm{W} \bigoplus \bm{V}$, which is the result of a binary morphological dilation, as shown in the right frame of Figure~\ref{fig:excluded_volume}.

\end{multicols}

\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\linewidth]{fig/sphere_volume_and_surface_projection.png}
    \caption{
        Surface and volume projections for a spherical particle with diameter $d = 8$ in a cylindrical lattice, shown for a set of distances $r_c = \{0, 2, 4, 6\}$ from the sphere particle center to the $z$-axis, and an arbitrary particle center coordinate $z_c$.
        The sphere center is indicated with a red cross.
        The heatmaps are drawn with equal aspect ratio; the $z$-axis is omitted in the figure.
        The color code is shown with the colorbar on top, where blue corresponds to zero and yellow corresponds to values above 25 units.
        The units for surface and volume are $a^2$ and $a^3$, respectively, where $a$ is the lattice unit length.
        The sphere surface projection $S_{\theta \downarrow}\{r_c\}$ on the $rz$-plane is shown in the upper set of heatmaps, and the volume projection $V_{\theta \downarrow}\{r_c\}$ is shown in the lower set of heatmaps.
        \\
        The discretization results in the surface and volume projection matrices $\bm{S}\{r_c\}$ and $\bm{V}\{r_c\}$, respectively, which are shown in the right frame.
    }
    \label{fig:sphere_volume_and_surface_projection}
\end{figure}


\begin{figure*}[h]
    \centering
    \includegraphics[width=0.8\linewidth]{fig/coordinate_system.png}
    \caption{
        (Left)
        The steady-state solution of the diffusion equation for a point-like particle diffusing through a finite-thickness empty cylindrical pore.
        The iso-concentration surfaces $c = \textrm{const}$ are shown with a contour plot, with concentration values labeled.
        For an empty pore, $\psi = c$; for a brush-filled pore, $\psi \approx c \exp(\Delta F / k_B T)$.
        The blue and red axes are radial and radial and axial coordinates, respectively.
    }
    \label{fig:empty_pore_solution}
    \caption{
        (Right)
        Special orthogonal curvilinear coordinate system for a pore with radius $r_{\textrm{pore}} = 20$ and thickness $L = 20$.
        \\
        Solid lines represent surfaces of rotation along the pore axis.
        Red lines show the constant $x_{z}$ surfaces; blue lines are the constant $x_{r}$ surfaces.
        The constant $x_{\theta}$ semi-planes are not shown.
        \\
        A local basis of the coordinate system $\hat{e}_r, \hat{e}_z$ is shown with arrows.
        The local basis defines scale coefficients $h_r = |\hat{e}_r|$, $h_z = |\hat{e}_z|$, $h_{\theta} = |\hat{e}_{\theta}|$.
        }
    \label{fig:coordinate_system}
\end{figure*}

\pagebreak
\section{Analytical Pore Resistance Estimation}
\begin{multicols}{2}

% \begin{figure}[H]
%     \centering
%     \includegraphics[width=0.8\linewidth]{fig/empty_pore_contour.png}
%     \caption{

%         }
%     \label{fig:empty_pore_solution}
% \end{figure}

Consider a medium with a constant diffusion coefficient $D_0$, separated by an impermeable membrane with a cylindrical pore.
The pore is placed at the origin of the cylindrical coordinate system, with the main axis of the pore coaxial with the $z$-axis.
Let the concentration of the solute in the semi-infinite bulk on one side be $c(z = -\infty) = 1$ and $c(z = +\infty) = 0$ in the bulk on the other side.
The steady-state solution $\frac{\partial c}{\partial t} = 0$ of the diffusion equation is a concentration profile shown in Figure~\ref{fig:empty_pore_solution}.
It is known that for a pore in an infinitely thin membrane (an orifice), the iso-concentration lines form oblate spheroids with the pore acting as a focal circle, and even for a membrane with finite thickness, this remains a good approximation.
The flux intensity field is the gradient of concentration, $\mathbf{j} = -D_0 \nabla c$.

A polymer brush grafted in the pore modulates the local diffusion coefficient $D$ and creates a free energy landscape.
The iso-concentration lines in the steady state are no longer oblate spheroids, although the steady-state solution still shares the structure with an empty pore in a medium with a constant diffusion coefficient.
As the flux intensity is a conservative vector field, we introduce a scalar potential function $\psi$, such that $\mathbf{j} = -D \nabla \psi$.
This scalar field $\psi \approx c \exp(\Delta F / k_B T)$ is a modified Boltzmann distribution and has a structure similar to the steady-state solution of an empty pore; i.e., the iso-values are oblate spheroids with the pore acting as a focal circle.

Consider an orthogonal curvilinear coordinate system $x_{\theta}, x_{r}, x_{z}$ with iso-surfaces defined as follows:
the level set of the potential function $\psi$ with a constant $x_{z}$ indexed by its intersection with the $z$-axis;
stream surfaces of diffusing particles with constant $x_{r}$ indexed by the radius $r$ of its intersection at $z = 0$;
half-planes with a constant azimuthal angle $x_{\theta}$:
\begin{gather}
    x_z = \left\{ (r, z) \mid \psi = \psi(r = 0, z) \right\}
    \\
    x_r = \left\{ (r, z) \mid \nabla f \cdot \nabla \psi = 0, f = f(r, z = 0) \right\}
    \\
    x_{\theta} = \theta
\end{gather}

For an orifice, this curvilinear coordinate system is a variant of the oblate spheroidal coordinate system, where surfaces of constant $x_{\theta}$ are half-planes, surfaces of constant $x_{r}$ are confocal hyperboloids of revolution, and surfaces of constant $x_{z}$ are confocal oblate spheroids.
The focal circle is the pore circumference.

For an empty pore with finite thickness, the iso-surfaces can be approximated such that the resulting curvilinear coordinate system is a joint of cylindrical and oblate spheroidal coordinate systems,
where cylindrical coordinates are used inside the pore $z \in [-L/2, L/2]$ and oblate spheroidal coordinates otherwise.

We exemplify the curvilinear coordinate system for a pore with finite thickness $L = 20$ and radius $r_{\textrm{pore}}$ in Figure~\ref{fig:coordinate_system}.

The interior cylindrical coordinate transformations and scale factors are defined as follows:
\begin{gather}
    \label{eq:cyl_transformation_1}
    x = x_r \cos(x_{\theta}), \quad
    y = x_r \sin(x_{\theta}), \quad
    z = x_z
    \\
    \label{eq:cyl_transformation_2}
    h_r = 1, \quad
    h_z = 1, \quad
    h_{\theta} = x_r
\end{gather}

The exterior oblate spheroidal coordinate system transformations and scale factors are:
\begin{gather}
    \begin{aligned}\label{eq:oblate_spheroid_transformation_1}
        x &= x_r
        \sqrt{1 + \frac{(|x_z| - L/2)^2}{r_{\textrm{pore}}^2}}
        \cos(x_{\theta})
        \\
        y &= x_r
        \sqrt{1 + \frac{(|x_z| - L/2)^2}{r_{\textrm{pore}}^2}}
        \sin(x_{\theta})
        \\
        z &= (|x_z| - L/2) \frac{\sqrt{r_{\textrm{pore}}^2 - x_r^2}}{r_{\textrm{pore}}} + \operatorname{sgn}(x_z) \frac{L}{2}
    \end{aligned}
    \\[4pt]
    \begin{aligned}\label{eq:oblate_spheroid_transformation_2}
        h_r &= \frac{\sqrt{r_{\textrm{pore}}^2 + (|x_z| - L/2)^2 - x_r^2}}{\sqrt{r_{\textrm{pore}}^2 - x_r^2}}
        \\
        h_z &= \frac{\sqrt{r_{\textrm{pore}}^2 + (|x_z| - L/2)^2 - x_r^2}}{\sqrt{r_{\textrm{pore}}^2 + (|x_z| - L/2)^2}}
        \\
        h_{\theta} &= \frac{x_r \sqrt{r_{\textrm{pore}}^2 + (|x_z| - L/2)^2}}{r_{\textrm{pore}}}
    \end{aligned}
\end{gather}

We assume that in the selected coordinate system, the flux is always normal to constant $x_z$ surfaces, which is exact for point-like particles passing through an orifice.

When the steady-state solution to the Smoluchowski equation is postulated to be a modified Boltzmann distribution, the product $\rho = D e^{-\Delta F / k_B T}$ can be recognized as local conductivity, as we also noted in our previous paper~\cite{Laktionov2023}.

Integration over the constant $x_z$ surfaces gives the inverse resistance per unit length (as appropriate for resistors connected in parallel), and the integration over each $x_z$ coordinate simply adds contributions from all the slices connected in series.

\begin{gather}
    \label{eq:R_z_analyt}
    R_z^{-1} = \int\displaylimits_{0}^{r_{\textrm{pore}}} \int\displaylimits_{0}^{2\pi} \rho^{-1} h_r h_{\theta} h_z^{-1} dx_{\theta} dx_r
    \\
    \label{eq:h_integrand}
    \begin{aligned} 
        &h_r h_{\theta} h_z^{-1} = \\ &=
        \begin{cases}
            x_r, \textrm{ if } x_z \in [-L/2,L/2]
            \\[2pt]
            \dfrac{x_r}{r_{\textrm{pore}}}\dfrac{r_{\textrm{pore}}^2 + (|x_z|-L/2)^2}{\sqrt{r_{\textrm{pore}}^2 - x_r^2}}, \textrm{ otherwise}
        \end{cases}
    \end{aligned}
    \\
    \label{eq:R_analyt}
    R = \int_{-\infty}^{+\infty} R_z \, dx_z
\end{gather}

Here, $R_z \, dx_z$ is the resistance of an oblate spheroid shell in the exterior region $x_z \notin [-L/2, L/2]$ and a circular disk in the interior of the pore $x_z \in [-L/2, L/2]$.

The physical meaning of the integrand in eq.~\ref{eq:R_z_analyt} is the conductivity of a conductor with cross-sectional area $h_r h_{\theta}$, length $h_z$, and specific conductivity $\rho^{-1}$.
In eq.~\ref{eq:h_integrand}, we write the part of the integrand corresponding to the interior and exterior regions of the pore, using scale factors from eqs.~\ref{eq:cyl_transformation_2} and \ref{eq:oblate_spheroid_transformation_2}, respectively.
The total resistance is the sum of the resistances of all the $x_z$ layers, as in eq.~\ref{eq:R_analyt}.

Consider an empty pore with finite thickness; let us apply eq.~\ref{eq:R_z_analyt} to find its resistance to a point-like particle.
For a pore without a polymer brush, the local conductivity is not modulated, so $\rho^{-1} = D_0^{-1}$.
\begin{gather}
    \label{eq:r_z_empty}
    R_{z, \textrm{empty}}^{-1} = 
    \begin{cases}
        D_0 \pi r_{\textrm{pore}}^2 \textrm{, if } |x_z| < L/2
        \\
        D_0 2 \pi \left((|x_z|-L/2)^2 + r_{\textrm{pore}}^2\right) \textrm{, otherwise} 
    \end{cases}
\end{gather}

Finally, when we integrate over the $x_z$ domain, we get the classic equation~\cite{Brunn1984}:
\begin{equation}
    \label{eq:r_empty}
    R_{\textrm{empty}} = \int\displaylimits_{-\infty}^{+\infty} R_{z, \textrm{empty}} dx_z
    =\frac{L}{D_0 \pi r_{\textrm{pore}}^2} + \frac{1}{D_0 2 r_{\textrm{pore}}}
\end{equation}

The local conductivities we calculated with SF-SCF are discrete values on a regular lattice
In this discrete cylindrical lattice, when integrating, we treat iso-potential lines as surfaces of half-cylinders rather than surfaces of oblate spheroids, as shown in Figure~\ref{fig:integration_scheme}.
Finally, a half-cylinder shell has a larger surface area and smaller resistance than an oblate spheroid shell for the same $x_z$, which is corrected by introducing a prefactor $f$ in the integrand.

The resistance integration on the regular cylindrical lattice:
\begin{gather}
    \label{eq:r_z_num}
    \begin{aligned} 
        &R_z^{-1} =
        \\
        &=\begin{cases}
             \pi \sum_{r=0}^{r_{\textrm{pore}}} \rho^{-1}_{[r,z]} (2r+1) \textrm{, if } z\in[-L/2,L/2]
             \\[4pt]
             \begin{aligned}
                &\textrm{otherwise}
                \\
                &\pi f(z) \left(\sum_{r=0}^{r_{\textrm{base}}} \rho^{-1}_{[r,z]} (2r+1) + 2 r_{\textrm{base}} \sum_{z^{\prime} = z_{a}}^{z_{b}}\rho^{-1}_{[r,z^{\prime}]}\right)
             \end{aligned}
        \end{cases}
    \end{aligned}
    \\
    \begin{cases}
        z_{a} = z, z_{b} = -L/2-1, \textrm{if } z < -L/2
        \\
        z_{a} = L/2, z_{b} = z, \textrm{if } z > L/2
    \end{cases}
    \\
    \label{eq:r_base}
    r_{\textrm{base}} = r_{\textrm{pore}} + |z| - L/2
    \\
    \label{eq:prefactor}
    \begin{aligned}
        &f(x_z) =\\
        & = \frac{2(|x_z|-L/2)^2 + 2r_{\textrm{pore}}^2}{(3(|x_z|-L/2)+r_{\textrm{pore}})((|x_z|-L/2)+r_{\textrm{pore}})}
    \end{aligned}
\end{gather}

where $f$ represents the ratio of the conductivities of an oblate spheroid shell and a half-cylinder shell for shells that share the same cross-section with the $z$-axis.

The way we iterate over cylindrical lattice elements in eq.~\ref{eq:r_z_num} is shown in Figure~\ref{fig:integration_scheme}.
In the interior of the pore $x_z \in [-L/2, L/2]$, the conductors are thin disks with inhomogeneous conductivity.
We assume no radial flux in the interior, so the conductivity of a disk centered at $z$ is approximated by $\pi \sum_{r=0}^{r_{\textrm{pore}}} \rho^{-1}_{[r,z]} (2r + 1)$.
In the exterior of the pore, $x_z \notin [-L/2, L/2]$, to mimic the oblate spheroid shape, the conductors are thin half-cylinder shells with radius $r_{\textrm{base}}$ and element length $|z| - L/2$, with inhomogeneous conductivity.
\begin{figure}[H]
    \centering
    \includegraphics[width=\linewidth]{fig/resistance_integration.png}
    \caption{
        Numerical integration of local conductivity/resistance on the cylindrical lattice.
        For the exterior region, conductivities are summed over half-cylinder shells, shown in red.
        In the interior region, the conductivities are summed over cylindrical disks, shown in blue.
        Half-cylinder shells mimic the oblate spheroid iso-potential profiles of the analytical solution to the empty pore problem.
        }
    \label{fig:integration_scheme}
\end{figure}

To account for the resistance of semi-infinite reservoirs outside the integration region on the cylindrical lattice, we integrate the analytical eq.~\ref{eq:R_z_analyt} from the integration boundary $z$ to infinity over $x_z$:

\begin{eqnarray}
    \label{eq:r_reservoir}
    R_{(z, \pm\infty)} = \pm \int\displaylimits_{z}^{\pm\infty} R_z \, dx_z = \dfrac{\pi - 2 \arctan\left( \dfrac{|z| - L/2}{r_{\textrm{pore}}} \right)}{4 \pi r_{\textrm{pore}}}
\end{eqnarray}

Finally, the total resistance of the pore, integrated on the discrete cylindrical lattice, is:

\begin{eqnarray}
    R_{\textrm{pore}} = \sum_{z=-L/2}^{L/2} R_z
    \\
    R_{\textrm{conv}} = R_{(z_{a}, -\infty)} + \sum\limits_{\mathclap{\substack{z \in [z_{a},-L/2)\\z \in (L/2, z_b]}}} R_z + R_{(z_{b}, +\infty)}
    \\
    \label{eq:R_total}
    R = R_{\textrm{conv}} + R_{\textrm{pore}}
\end{eqnarray}
where $R_{\textrm{pore}}$ is the resistance of the pore channel, $R_{\textrm{conv}}$ is a resistance of the convergent flux in the pore exterior.
The eq.\ref{eq:R_total} concludes the analytical estimation with the total resistance of the pore.


\end{multicols}

\section{Validating Analytical Approaches with CFD Simulations}

\begin{multicols}{2}
The diffusion of nanocolloids in the presence of an effective potential is governed by the Smoluchowski diffusion equation:
\begin{equation}
    \label{eq:Smoluchowski}
    \frac{\partial c}{\partial t} = \nabla \cdot D(\nabla c + c \nabla \Delta F)
\end{equation}
where $c$ is the concentration of the colloid particles, $D$ is the local diffusion coefficient, and $\Delta F$ is the position-dependent insertion free energy, which plays the role of the potential of mean force
Our interest is in a stationary solution to the Smoluchowski diffusion equation, i.e., when $\frac{\partial c}{\partial t} = 0$.

To the best of our knowledge, a general analytical solution of the stationary equation is not available.
In the previous section, we discussed an analytical approximation we constructed with a set of assumptions
Here, we present numerical results via computational fluid dynamics (CFD) simulation.
The method requires no assumptions about concentration profiles and results directly in a flux density field $\mathbf{j}$.

The mass conservation equation connects the rate of change in the colloid concentration and the flux density field:
\begin{equation}
    \frac{\partial c}{\partial t} = -\nabla \cdot \mathbf{j}
\end{equation}

From the position-dependent flux density, the total flux through the pore is found by integration over a control cross-section.
The control cross-section is an arbitrary surface that divides the system with the pore into two separated parts.
For convenience, we select a cross-section at the pore center ($z = 0$), as there is only an axial component $j_z$ to the flux.
Then the total flux through the pore is
\begin{equation}
    \label{eq:total_flux_1}
    J = \oint\limits_{S} \mathbf{j} \cdot d\mathbf{S} = 2 \pi \int_0^{r_\textrm{pore}} j_z(r, z = 0) \, r \, dr
\end{equation}

We employ the finite volume method to simulate transport of the nanocolloid particles through the pore.

The key step in the finite volume method is the control volume integration using the divergence theorem:
\begin{equation}
    \label{eq:CFD_integration_1}
    \left( \frac{\partial c}{\partial t} \right)_{\textrm{CV}} = -\int\limits_{\textrm{CV}} \nabla \cdot \mathbf{j} \, dV = -\oint\limits_{\textrm{CV}} \mathbf{j} \cdot d\mathbf{S}
\end{equation}

To update the average colloid concentration $c$ in a control volume, we use the forward Euler time integration method:
\begin{equation}
    c_{t + \Delta t} = c_t + \left( \frac{\partial c}{\partial t} \right)_{\textrm{CV}} \Delta t
\end{equation}
where $c_{t + \Delta t}$ and $c_t$ are the average colloid concentrations in a control volume at times $t + \Delta t$ and $t$, respectively
We stop updating $c$ when $\left( \frac{\partial c}{\partial t} \right)_{\textrm{CV}}$ becomes negligible, indicating that the stationary solution has been reached.

For the finite volume method, the domain has to be divided into discrete control volumes.
Identical to the previous section, we use a discrete cylindrical lattice; we remind that as the system has axial symmetry, the lattice has two dimensions with each control volume has four neighboring control volumes.

The usual convention is to assign letters for each neighboring control volume and shared faces.
The properties averaged over some selected control volume are subscripted with $P$ or with $E$, $W$, $N$, $S$ for the neighboring control volumes to the east, west, north, and south, respectively.
The properties defined on the faces of a control volume are subscripted with $e$, $w$, $n$, $s$, depending on the neighbor the face is shared with (see Figure~\ref{fig:CFD_element}).

\begin{figure}[H]
    \centering
    \includegraphics[width=\linewidth]{fig/CFD_element.png}
    \caption{
        Schematic diagram of control volume, domain discretization, and labeling convention.
        The control volume (red square on the left frame) is surrounded by four neighbors to the east, west, north, and south (E, W, N, S), with faces labeled with lowercase letters.
        The discretized domain is a regular cylindrical lattice with $\delta r = \delta z = a$, identical to the lattice in SF-SCF calculations.
        The fluxes across the faces are shown in the right frame with arrows.
        The dilution effect of the larger control volumes is accounted for with $\lambda_{e,w,n,s}$.
        }
    \label{fig:CFD_element}
\end{figure}

In the cylindrical lattice, the control volumes increase with radial coordinate $r$; hence, when a quantity of colloid particles is transported in the radial direction, the colloid particles get diluted.
The dilution effect is accounted for with $\lambda_{e,w,n,s}$, which is the ratio between control volumes that share a face, with the selected control volume in the denominator:
\begin{eqnarray}
    \lambda_n =\begin{cases}
        1 + \dfrac{1}{r}, & \text{if } r \ne 0\\
        2, & \text{if } r = 0
    \end{cases}
    \\
    \lambda_s =\begin{cases}
        1 - \dfrac{1}{r}, & \text{if } r \ne 0\\
        0, & \text{if } r = 0
    \end{cases}
    \\
    \lambda_{e} = \lambda_{w} = 1
\end{eqnarray}

The discrete form of the divergence theorem in eq.~\ref{eq:CFD_integration_1} is
\begin{equation}
    \label{eq:CFD_integration_2}
    \left( \frac{\partial c}{\partial t} \right)_{\textrm{CV}} = \lambda_w j_w + \lambda_s j_s - \lambda_e j_e - \lambda_n j_n
\end{equation}
where the signs before each term are positive if the flux is into the control volume and negative if the flux is out of the control volume (see Figure~\ref{fig:CFD_element}).

The flux of colloid particles, as one can see from the Smoluchowski diffusion equation, is caused by the gradient in the colloid concentration and the gradient in the insertion free energy
Let us call these contributions the diffusion and drift fluxes, $j_{\textrm{diffusion}}$ and $j_{\textrm{drift}}$, respectively.

The following equations are written only for the northern direction and are identical for the other directions.
The diffusion flux and drift terms contributing to the flux intensity are
\begin{eqnarray}
    j_n = j_{\textrm{diffusion}, n} + j_{\textrm{drift}, n} \\
    j_{\textrm{diffusion}, n} = - D_n (c_N - c_P) \\
    j_{\textrm{drift}, n} = - D_n c_n (\Delta F_N - \Delta F_P)
\end{eqnarray}
where the capital letter subscripts denote the property average values over the control volumes, and the lowercase letters denote the property values at the faces, as shown in Figure~\ref{fig:CFD_element}.
The diffusion coefficient at the face is found as a simple arithmetic mean:
\begin{equation}
    D_n = \frac{D_N + D_P}{2}
\end{equation}

When the flux is dominated by the insertion free energy gradient, the colloid concentration at face $c_n$ cannot be found as a simple arithmetic mean.
The choice of $c_n$ must reflect the dominant direction of the flux.

So called \emph{exponential scheme} uses the exact analytical solution of a one-dimensional equation for diffusion in a potential field to estimate the colloid concentration at face $c_n$.
This estimate is suitable in a wide range of conditions, from diffusion-dominated to drift-dominated transport \cite{Patankar1980,Versteeg2007}.

It does so by modifying the weight between the colloid concentrations $c_N$ and $c_P$ in the neighboring control volumes based on the local insertion free energy gradient.

The colloid concentration at the face is given by the formula:
\begin{equation}
    \label{eq:upwind}
    c_n = c_N + (c_P - c_N) \frac{\exp\left( \dfrac{\Delta F_N - \Delta F_P}{2} \right) - 1}{\exp\left( \Delta F_N - \Delta F_P \right) - 1}
\end{equation}

At $\Delta F_N = \Delta F_P$, eq.~\ref{eq:upwind} reduces to a simple arithmetic mean, while for $\Delta F_N - \Delta F_P > 10$, the neighboring control volume does not contribute to the colloid concentration at face $c_n \approx c_P$, as the dominant drift flux is directed outwards.
Conversely, when $\Delta F_N - \Delta F_P < -10$, the dominant drift flux is directed inwards, so the colloid concentration at face $c_n \approx c_N$.




Finally, when the stationary state is reached, we calculate the total flux through the pore with the discrete form of eq.~\ref{eq:total_flux_1}:
\begin{equation}
    \label{eq:total_flux_2}
    J = \frac{\pi}{4} j_z[ r = 0, z = 0 ] + \pi \sum_{r = 1}^{r_\textrm{pore}} 2 r \, j_z[ r, z = 0 ]
\end{equation}

The resistance of the pore is found from the simple equation $R = \dfrac{\Delta c}{J}$, similar to Ohm's law.

While, running CFD simulations to calculate the resistance is more computationally demanding than the approximate analytical scheme explained in the previous section and hides away some of the details on the pore resistance structure.
Nevertheless, there are major benefits to using it, since it requires no assumptions about the shape of the position-dependent colloid concentration $c$.
We employ CFD as a guide and sanity check for the developed approximate analytical scheme.
The comparison for a set of parameters is given in Figure~\ref{fig:CFD_comparison}.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.9\linewidth]{fig/resistivity_on_d_SI.png}
    \caption{
        Total resistance compared between numerical CFD and approximate analytical approaches as a function of particle size.
        Total resistance is calculated for a good solvent $\chi_{\textrm{PS}} = 0.3$ and a set of $\chi_{\textrm{PC}} = \{-1.00, -1.25, -1.50, -1.75, -2.00\}$ interaction parameters ranging from inert to adsorbing particles.
        The pore radius and length are kept at $r_{\textrm{pore}} = 26$, $L = 52$.
        \\
        The thick dashed line is the resistance of a pore with effective shape (volume exclusion).
        \\
        The upper thin horizontal line denoted with $L = 0$ is the resistance of an infinitesimally small pore (orifice).
        \\
        The lower thin horizontal line represents twice the resistance of a semi-infinite solution to an ideally absorbing sphere, which is an estimate for the case of sufficiently negative insertion free energy in the exterior of the pore, which is possible for a swollen polymer brush.
        \\
        The resistance is normalized by the viscosity $\eta_{0}$ of the pure solvent and particle size $d$, which eliminates colloid particles' hydrodynamic viscosity from consideration.
        }
    \label{fig:CFD_comparison}
\end{figure}


\end{multicols}
\section{Diffusion Coefficient Impact on the Trends in Pore Resistance}
\begin{multicols}{2}
    
Locally, the polymer brush resembles a semi-dilute polymer solution with segment concentration $\phi$, characterized by a correlation length $\xi$ that represents the typical mesh size formed by overlapping polymer coils.

According to the scaling theory developed by Cai et al.\cite{Cai2011}, for colloids smaller than the correlation length $\xi$, diffusion is unhindered and follows the Stokes--Einstein equation:
\begin{equation}
D \approx \frac{k_B T}{3 \pi \eta_0 d}
\label{eq:D_0}
\end{equation}
where $\eta_0$ is the solvent viscosity.

For colloids larger than $\xi$, diffusion is hindered and occurs via hopping between mesh cages, requiring polymer chain relaxation. The diffusion coefficient in this regime is given by \cite{Cai2011}:
\begin{equation}
D \approx D_0 \frac{\xi^2}{d^2}
\label{eq:D_m}
\end{equation}

To interpolate between Eqs.~\ref{eq:D_0} and \ref{eq:D_m}, we assume that the retarding effects due to solvent friction and mesh relaxation are additive:
\begin{equation}
D^{-1} = D_0^{-1} \left( 1 + \frac{d^2}{\xi^2} \right)
\label{eq:D_interp}
\end{equation}

To account for possible deviations, we introduce a prefactor $f$:
\begin{equation}
D^{-1} = D_0^{-1} \left( 1 + \frac{f^2 d^2}{\xi^2} \right)
\label{eq:D_interp_2}
\end{equation}
where larger values of $f$ decrease the local diffusion coefficient, effectively representing a larger particle size.

The prefactor $f$ is introduced to demonstrate the limited impact of variations in the local diffusion coefficient on the overall trends in pore resistance.

Figure~\ref{fig:permeability_ond_low_D} compares the pore resistance calculated using the position-dependent diffusion coefficient from Eq.~\ref{eq:D_interp} (thin lines) and Eq.~\ref{eq:D_interp_2} (thick lines with markers) with $f = 10$.

This comparison shows that even if the position-dependent diffusion coefficient is underestimated, the qualitative trends remain the same.

Lower diffusion coefficients correspond to higher pore resistance, shifting the resistance–particle size curves upward for smaller particles.

When the pore channel resistance $R_{\text{pore}}$ is negligible due to large negative insertion free energy, and the total resistance is mainly determined by the convergent flow resistance $R \approx R_{\text{conv}}$, changes in the position-dependent diffusion coefficient $D$ have little impact on the total resistance. This effect is observed in Figure~\ref{fig:permeability_ond_low_D} for highly attractive ($\chi_{\text{PC}} = -2.0$) particles with larger sizes in a $\theta$-solvent and moderately good ($\chi_{\text{PS}} = 0.3$) solvent.

Furthermore, a lower position-dependent diffusion coefficient exaggerates the portion of the trend with negative slope in the resistance–particle size dependency.

Since the local diffusion coefficient depends not only on the local polymer concentration and particle size but also on the molecular-level interactions between the polymer brush and the particle, which are not captured by our coarse-grained approach, incorporating more complex models or empirical data into the calculation of $D$ will not drastically change the trends and structure of the pore resistance.


\end{multicols}

\begin{figure}[H]
    \centering
    \includegraphics[width = 0.9\linewidth]{fig/permeability_on_d_low_D.png}
    \caption{
        Comparison of pore resistance as a function of particle size using different position-dependent diffusion coefficients.
        Thin lines represent calculations using Eq.~\ref{eq:D_interp}, while thick lines with markers represent calculations using Eq.~\ref{eq:D_interp_2} with $f = 10$.
        Results are shown for a set of $\chi_{\text{PS}}$ typed in the titles and various values of the particle-polymer interaction parameter $\chi_{\text{PC}}$ listed in legend,.
        The figure illustrates that even when the local diffusion coefficient is significantly reduced (larger $f$), the qualitative trends in pore resistance remain consistent.
        Lower diffusion coefficients correspond to higher pore resistance, shifting the resistance–particle size curves upward for smaller particles.
        }
    \label{fig:permeability_ond_low_D}
\end{figure}


\pagebreak
\subsection*{List of variables and abbreviations}

%\begin{multicols}{2}
\begin{tabularx}{\linewidth}{l X}
    % \toprule
    % \textbf{Variable} & \textbf{Definition} \\
    % \midrule
    $a$ & Kuhn segment length \\
    $b_0$, $b_1$ & Polymer depletion/accumulation correction coefficients \\
    $c$ & Local concentration of diffusing colloid particles in the steady state \\
    $c_{\textrm{N}}$ & Concentration in the neighboring control volume \\
    $c_{\textrm{n}}$ & Concentration at the face between the current and neighboring control volumes \\
    $c_{t}$ & Concentration in a control volume at time $t$ \\
    $d$ & Diameter of the spherical or cylindrical colloid particle \\
    $D$ & Local diffusion coefficient of colloid particles \\
    $D_0$ & Diffusion coefficient of colloid particles in pure solvent \\
    $D_{\textrm{N}}$ & Local diffusion coefficient in the neighboring control volume \\
    $D_{\textrm{n}}$ & Local diffusion coefficient at the face between the current and neighboring control volumes \\
    $\delta r$, $\delta z$ & Size of the discretization step in radial and axial directions \\
    $\Delta F$ & Analytical insertion free energy penalty to place a spherical particle \\
    $\Delta F_{\textrm{cyl}}$ & Analytical insertion free energy penalty to place a cylindrical particle \\
    $\Delta F_{\textrm{cyl}}^{\textrm{osm}}$ & Osmotic contribution to $\Delta F_{\textrm{cyl}}$ \\
    $\Delta F_{\textrm{cyl}}^{\textrm{sur}}$ & Surface contribution to $\Delta F_{\textrm{cyl}}$ \\
    $\Delta F_{\textrm{osm}}$ & Osmotic contribution to $\Delta F$ for a spherical particle\\
    $\Delta F_{\textrm{SF-SCF}}$ & Insertion free energy penalty to place a cylindrical particle calculated using the Scheutjens-Fleer approach \\
    $\Delta F_{\textrm{sur}}$ & Surface contribution to $\Delta F$ for a spherical particle\\
    $\Delta \phi$ & Change in polymer segment volume concentration due to the presence of a colloid particle \\
    $f(x_z)$ & Prefactor introduced to correct the difference between the resistance calculated using half-cylinder shells and oblate spheroid shells \\
    $G$ & Statistical weight of a subchain \\
    $\gamma$ & Surface tension coefficient \\
    $h_{r}$, $h_{z}$, $h_{\theta}$ & Scale factors (metric coefficients) in curvilinear coordinate transformations \\
    $i$, $k$ & Indices of the discretized grid in radial $r$ and axial $z$ directions, respectively \\
    $J$ & Net flux of colloid particles through the pore in the steady state \\
    $j$ & Colloid particle flux density in the steady state \\
    $j_{\textrm{diffusion}, n}$ & Diffusive flux density between control volumes in direction $n$ \\
    $j_{\textrm{drift}, n}$ & Drift flux density between control volumes in direction $n$ due to the insertion free energy gradient \\
    $j_{n}$ & Total flux density between control volumes in direction $n$ \\
    $k_B$ & Boltzmann constant \\
    $L$ & Membrane thickness \\
    $L_{\textrm{eff}}$ & Effective length of the pore considering volume exclusion \\
    $\lambda_{n}$ & Ratio of neighboring control volume sizes in direction $n$ \\
    $N$ & Number of Kuhn segments in the brush-forming chains \\
    $\Pi$ & Flory mean-field local osmotic pressure \\
    $\phi$ & Local volume fraction of polymer segments in a polymer brush \\
    $\phi^{\ast}$ & Apparent local volume fraction of polymer segments \\
    $\phi^{\textrm{ins}}$ & Local volume fraction of polymer segments disturbed by an inserted particle \\
    $\psi$ & Scalar potential function introduced to express the steady state solution \\
    $\rho$ & Local resistivity (inverse conductivity) to colloid particle diffusion \\
    $r$ & Radial coordinate in cylindrical coordinates \\
    $r_{\textrm{base}}$ & Base radius of half-cylinder shells used in resistance calculations\\
    $r_{\textrm{pore}}$ & Radius of the pore \\
    $r_{\textrm{pore, eff}}$ & Effective radius of the pore considering volume exclusion \\
    $r_{c}$ & Radial coordinate of the colloid particle center in cylindrical coordinates \\
    $R$ & Total resistance of the pore to colloid particle diffusion in a semi-infinite solution \\
    $R^{\textrm{empty}}$ & Total resistance of an empty pore (without polymer brush) \\
    $R_{(z, \pm\infty)}$ & Resistance from position $z$ to infinity along positive or negative $z$-direction \\
    $R_{\textrm{conv}}$ & Convergent flow contribution to the total resistance \\
    $R_{\textrm{pore}}$ & Resistance contribution from the pore channel \\
    $R_{z}$ & Resistance per unit length at position $z$ \\
    $R_{z, \textrm{empty}}$ & Resistance per unit length at position $z$ for an empty pore \\
    $\sigma$ & Grafting density (number of polymer chains per unit area) \\
    $T$ & Temperature \\
    $\theta$ & Angular coordinate in cylindrical coordinates \\
    $u$ & Segment potential in Scheutjens-Fleer method\\
    $\xi$ & Correlation length in a semi-dilute polymer solution \\
    $z$ & Axial coordinate in cylindrical coordinates \\
    $z_a$, $z_b$ & Integration limits along the $z$-axis \\
    $z_{c}$ & Axial coordinate of the colloid particle center in cylindrical coordinates \\
    $\bm{1}_{V}$, $\bm{1}_{S}$ & Volume and surface indicator functions \\
    $\bm{e}_r$, $\bm{e}_z$ & Local covariant basis vectors in curvilinear coordinates \\
    $\bm{J}$ & Jacobian matrix \\
    $\bm{S}\{r_{c}\}$ & Particle surface projection matrix for a spherical particle with center at $r_{c}$ \\
    $\bm{S}_{\theta\downarrow}$ & Particle surface projection onto the $rz$-plane for a spherical particle with center at $r_{c}$ \\
    $\bm{T}$ & Coordinate system transformation matrix \\
    $\bm{V}$ & Boolean array representing the presence of the spherical particle in the discretized grid \\
    $\bm{V}\{r_{c}\}$ & Particle volume projection matrix for a spherical particle with center at $r_{c}$ \\
    $\bm{V}_{\theta\downarrow}$ & Particle volume projection onto the $rz$-plane for a spherical particle with center at $r_{c}$ \\
    $\bm{W}$ & Boolean array representing the membrane walls in the discretized grid \\
    $\bm{W}^{\ast}$ & Boolean array representing the space impermeable to the spherical particle \\
    $\chi_{\textrm{CS}}$ & Flory colloid-solvent interaction parameter \\
    $\chi_{\textrm{PC}}$ & Flory polymer-colloid interaction parameter \\
    $\chi_{\textrm{PS}}$ & Flory polymer-solvent interaction parameter \\
    %\bottomrule
\end{tabularx}
%\end{multicols}

\printbibliography
\end{document}